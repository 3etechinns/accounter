<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
                "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field">


	<database-object>
		<create> 
		CREATE OR REPLACE FUNCTION function_customer() RETURNS TRIGGER as	
		$trigger_customer$
		BEGIN
		IF TG_OP='INSERT' THEN
			UPDATE ACCOUNT SET OPENING_BALANCE = OPENING_BALANCE + NEW.BALANCE,CURRENT_BALANCE = CURRENT_BALANCE + NEW.BALANCE,TOTAL_BALANCE = TOTAL_BALANCE + NEW.BALANCE WHERE ID_ACCOUNT = NEW.ACCOUNTS_RECEIVABLE_ID;
		RETURN NEW;
		END IF;	
			RETURN NULL;
		END;
		
		 $trigger_customer$ LANGUAGE plpgsql;
		 </create>
		<drop>DROP FUNCTION IF EXIST function_customer</drop>
	</database-object>
	
	
	
	<database-object>
		<create> 
			
		CREATE TRIGGER trigger_customer AFTER INSERT OR UPDATE OR DELETE ON CUSTOMER FOR EACH ROW
		EXECUTE PROCEDURE function_customer();
		
	
		 </create>
		<drop>DROP TRIGGER trigger_customer</drop>
	</database-object>
	
</hibernate-mapping>