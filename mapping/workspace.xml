<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field">

	<class name="com.bizantra.server.workspace.ext.AbstractTool"
		table="ABSTRACTTOOL">
		<id name="id" column="ID">
			<generator class="native" />
		</id>
		<many-to-one name="space"
			class="com.bizantra.server.workspace.internal.WorkSpace" column="SPACE_ID"
			not-null="true" cascade="none">
		</many-to-one>
		<property name="toolID" column="TOOLID" length="40" />
		<property name="name" column="NAME" />
	</class>

	<!-- Named Queries for workspace.java -->
	<!-- getCommandata query same as in core -->

	<sql-query name="getLastSpaceCommandVersion">
		<query-param name="member" type="string" />
		<query-param name="device" type="int" />
		<query-param name="spaceID" type="string" />
		select MAX(c.version) from WORKSPACECOMMAND c where c.member=:member
		and c.device=:device and c.SPACE_ID=:spaceID
	</sql-query>
	
	<sql-query name="get.space.members.from.intigrated.company">
		<query-param name="spaceID" type="string" />
		<return alias="MEMBER" class="com.bizantra.server.workspace.internal.Member" ></return>
		SELECT M.* FROM MEMBER M 
		INNER JOIN EXTERNAL_ACCOUNT EA
			ON M.USER_ID = EA.USER_ID
		WHERE M.SPACE_ID=:spaceID and M.IS_DELETED=false
	</sql-query>
	
	
	

	<!--Exterlization of HQL   -->

	<!-- WorkSpace -->


	<!--
		<query name="abstractTool.by.toolid.and.spaceid"> <query-param
		name="toolID" type="string"/> <query-param name="spaceID"
		type="string"/> from AbstractTool tool where tool.toolID=:toolID and
		tool.space.spaceId=:spaceID </query>
	-->


	<query name="abstractTool.by.spaceid.and.toolid">
		<query-param name="toolID" type="string" />
		<query-param name="spaceId" type="string" />

		from AbstractTool tool where tool.toolID=:toolID and
		tool.space.spaceId=:spaceId
	</query>

	<query name="abstractTool.by.spaceid.and.toolName">
		<query-param name="toolName" type="string" />
		<query-param name="spaceId" type="string" />

		from AbstractTool tool where tool.name=:toolName and
		tool.space.spaceId=:spaceId
	</query>

</hibernate-mapping>